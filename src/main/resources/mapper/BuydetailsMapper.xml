<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lgeek.app.mapper.BuyDetailsMapper">
  <resultMap id="BaseResultMap" type="com.lgeek.app.model.BuyDetails">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    <id column="bd_id"  property="id" />
    <result column="bd_order_id"  property="orderId" />
    <result column="bd_request"  property="request" />
    <result column="bd_state"  property="state" />
    <result column="bd_confirm"  property="confirm" />
    <result column="bd_delivery"  property="delivery" />
    <result column="bd_comment"  property="comment" />
    <result column="bd_date"  property="date" />
    <result column="bd_quantity"  property="quantity" />
    <result column="bd_cost"  property="cost" />
    <result column="bd_name"  property="name" />
    <result column="bd_phone" property="phone" />
    <result column="bd_address"  property="address" />
    <result column="u_id" property="u_id" />
    <result column="p_id"  property="p_id" />
  </resultMap>
    <resultMap id="BaseResultMap2" type="com.lgeek.app.model.BuyDetails">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    <id column="bd_id"  property="id" />
    <result column="bd_order_id"  property="orderId" />
    <result column="bd_request"  property="request" />
    <result column="bd_state"  property="state" />
    <result column="bd_confirm"  property="confirm" />
    <result column="bd_delivery"  property="delivery" />
    <result column="bd_comment"  property="comment" />
    <result column="bd_date"  property="date" />
    <result column="bd_quantity"  property="quantity" />
    <result column="bd_cost"  property="cost" />
    <result column="bd_name"  property="name" />
    <result column="bd_phone" property="phone" />
    <result column="bd_address"  property="address" />
	<association property="shop" javaType="com.lgeek.app.model.Shop">
		<id column="s_id" property="id"/>
		<result column="s_name" property="name"/>
	</association>
	<association property="product" javaType="com.lgeek.app.model.Product">
		<id column="p_id" property="id" />
		<result column="p_name" property="name" />
		<result column="p_describe" property="describe" />
		<result column="p_price" property="price" />
		<result column="p_image" property="image" />
		<result column="p_stock" property="stock" />
		<result column="p_brand" property="brand" />	
		<result column="p_code" property="code" />
		<result column="p_model" property="model" />
		<result column="p_unit" property="unit" />
		<result column="p_untaxprice" property="untaxPrice" />	
		<result column="p_taxprice" property="taxPrice" />
		<result column="p_createtime" property="createTime" />
		<result column="p_flag" property="flag" />
		<association property="category" javaType="com.lgeek.app.model.Category">
			<id column="ca_id" property="id"/>
			<result column="ca_name" property="name"/>
		</association>
	</association>
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    bd_id, bd_order_id, bd_request, bd_state, bd_confirm, bd_delivery, bd_comment, bd_date, 
    bd_quantity, bd_cost, bd_name, bd_phone, bd_address, u_id, p_id
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from buydetails
    where bd_id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    delete from buydetails
    where bd_id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.lgeek.app.model.BuyDetails">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    insert into buydetails (bd_id, bd_order_id, bd_request, 
      bd_state, bd_confirm, bd_delivery, 
      bd_comment, bd_date, bd_quantity, 
      bd_cost, bd_name, bd_phone, 
      bd_address, u_id, p_id
      )
    values (#{bdId,jdbcType=INTEGER}, #{bdOrderId,jdbcType=VARCHAR}, #{bdRequest,jdbcType=VARCHAR}, 
      #{bdState,jdbcType=VARCHAR}, #{bdConfirm,jdbcType=VARCHAR}, #{bdDelivery,jdbcType=VARCHAR}, 
      #{bdComment,jdbcType=VARCHAR}, #{bdDate,jdbcType=TIMESTAMP}, #{bdQuantity,jdbcType=INTEGER}, 
      #{bdCost,jdbcType=REAL}, #{bdName,jdbcType=VARCHAR}, #{bdPhone,jdbcType=VARCHAR}, 
      #{bdAddress,jdbcType=VARCHAR}, #{uId,jdbcType=VARCHAR}, #{pId,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.lgeek.app.model.BuyDetails">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    insert into buydetails
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        bd_id,
      </if>
      <if test="orderId != null">
        bd_order_id,
      </if>
      <if test="request != null">
        bd_request,
      </if>
      <if test="state != null">
        bd_state,
      </if>
      <if test="confirm != null">
        bd_confirm,
      </if>
      <if test="delivery != null">
        bd_delivery,
      </if>
      <if test="comment != null">
        bd_comment,
      </if>
      <if test="date != null">
        bd_date,
      </if>
      <if test="quantity != null">
        bd_quantity,
      </if>
      <if test="cost != null">
        bd_cost,
      </if>
      <if test="name != null">
        bd_name,
      </if>
      <if test="phone != null">
        bd_phone,
      </if>
      <if test="address != null">
        bd_address,
      </if>
      <if test="u_id != null">
        u_id,
      </if>
      <if test="product != null">
        p_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="orderId != null">
        #{orderId,jdbcType=VARCHAR},
      </if>
      <if test="request != null">
        #{request,jdbcType=VARCHAR},
      </if>
      <if test="state != null">
        #{state,jdbcType=VARCHAR},
      </if>
      <if test="confirm != null">
        #{confirm,jdbcType=VARCHAR},
      </if>
      <if test="delivery != null">
        #{delivery,jdbcType=VARCHAR},
      </if>
      <if test="comment != null">
        #{comment,jdbcType=VARCHAR},
      </if>
      <if test="date != null">
        #{date,jdbcType=TIMESTAMP},
      </if>
      <if test="quantity != null">
        #{quantity,jdbcType=INTEGER},
      </if>
      <if test="cost != null">
        #{cost,jdbcType=REAL},
      </if>
      <if test="name != null">
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="phone != null">
        #{phone,jdbcType=VARCHAR},
      </if>
      <if test="address != null">
        #{address,jdbcType=VARCHAR},
      </if>
      <if test="u_id != null">
        #{u_id,jdbcType=VARCHAR},
      </if>
      <if test="product != null">
        #{product.id,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.lgeek.app.model.BuyDetails">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    update buydetails
    <set>
      <if test="orderId != null">
        bd_order_id = #{orderId,jdbcType=VARCHAR},
      </if>
      <if test="request != null">
        bd_request = #{request,jdbcType=VARCHAR},
      </if>
      <if test="state != null">
        bd_state = #{state,jdbcType=VARCHAR},
      </if>
      <if test="confirm != null">
        bd_confirm = #{confirm,jdbcType=VARCHAR},
      </if>
      <if test="delivery != null">
        bd_delivery = #{delivery,jdbcType=VARCHAR},
      </if>
      <if test="comment != null">
        bd_comment = #{comment,jdbcType=VARCHAR},
      </if>
      <if test="date != null">
        bd_date = #{date,jdbcType=TIMESTAMP},
      </if>
      <if test="quantity != null">
        bd_quantity = #{quantity,jdbcType=INTEGER},
      </if>
      <if test="bdCost != null">
        bd_cost = #{bdCost,jdbcType=REAL},
      </if>
      <if test="name != null">
        bd_name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="phone != null">
        bd_phone = #{phone,jdbcType=VARCHAR},
      </if>
      <if test="address != null">
        bd_address = #{address,jdbcType=VARCHAR},
      </if>
      <if test="u_id != null">
        u_id = #{uId,jdbcType=VARCHAR},
      </if>
      <if test="p_id != null">
        p_id = #{p_id,jdbcType=VARCHAR},
      </if>
    </set>
    where bd_id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.lgeek.app.model.BuyDetails">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    update buydetails
    set bd_order_id = #{orderId,jdbcType=VARCHAR},
      bd_request = #{request,jdbcType=VARCHAR},
      bd_state = #{state,jdbcType=VARCHAR},
      bd_confirm = #{confirm,jdbcType=VARCHAR},
      bd_delivery = #{delivery,jdbcType=VARCHAR},
      bd_comment = #{comment,jdbcType=VARCHAR},
      bd_date = #{date,jdbcType=TIMESTAMP},
      bd_quantity = #{quantity,jdbcType=INTEGER},
      bd_cost = #{cost,jdbcType=REAL},
      bd_name = #{name,jdbcType=VARCHAR},
      bd_phone = #{phone,jdbcType=VARCHAR},
      bd_address = #{address,jdbcType=VARCHAR},
      u_id = #{u_id,jdbcType=VARCHAR},
      p_id = #{p_id,jdbcType=VARCHAR}
    where bd_id = #{id,jdbcType=INTEGER}
  </update>
    <select id="getUnfinishedOrdersByUid"  resultMap="BaseResultMap2">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    SELECT * FROM buydetails b join product p on b.p_id=p.p_id join shop s on p.s_id=s.s_id   
    where u_id = #{u_id} and  bd_state = 'true' order by bd_order_id desc
  </select>
  <select id="getUnfinishedOrdersByOrderId"  resultMap="BaseResultMap2">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jun 04 14:46:37 CST 2018.
    -->
    SELECT * FROM buydetails b join product p on b.p_id=p.p_id join shop s on p.s_id=s.s_id  
    join category ca on p.ca_id =  ca.ca_id
    where bd_order_id = #{orderId} and  bd_state = 'true' 
  </select>
  	<update id="payment">
	update buydetails set bd_request = #{name} , bd_state='true' where bd_order_id=#{orderId}
	</update>
</mapper>